[
  {
    "id": "ch5_q1",
    "type": "short",
    "question": "SPF چیست و چه نقشی در امنیت ایمیل دارد؟",
    "answer": "**SPF (Sender Policy Framework)** رکوردی در DNS است که مشخص می‌کند کدام سرورها مجاز به ارسال ایمیل از طرف یک دامنه هستند و این کمک می‌کند تا جعل فرستنده شناسایی شود.",
    "hint": "- **SPF = شناسنامه فرستنده**\n- بررسی می‌کند آیا IP فرستنده در لیست مجاز دامنه وجود دارد یا خیر.",
    "extra": "### کاربرد:\n- جلوگیری از **Email Spoofing**\n- استفاده در ترکیب با DKIM و DMARC برای تأیید فرستنده.\n\n### ADHD نکته:\nSPF را مثل لیست افرادی تصور کن که اجازه دارند از طرفت نامه بفرستند."
  },
  {
    "id": "ch5_q2",
    "type": "short",
    "question": "DKIM چیست و چگونه کار می‌کند؟",
    "answer": "**DKIM (DomainKeys Identified Mail)** مکانیزمی است که به ایمیل یک امضای دیجیتال اضافه می‌کند تا گیرنده بتواند تأیید کند ایمیل واقعاً از دامنه فرستنده آمده و در مسیر تغییر نکرده است.",
    "hint": "- **DKIM = مهر و موم دیجیتال پاکت نامه**\n- امضا با کلید خصوصی تولید و با کلید عمومی در DNS تأیید می‌شود.",
    "extra": "### کاربرد:\n- تضمین تمامیت (Integrity) و اعتبار (Authenticity) ایمیل.\n- جلوگیری از دستکاری محتوای ایمیل در مسیر.\n\n### ADHD نکته:\nتصور کن یک نامه با لاک و مهر مخصوص که فقط صاحبش دارد ارسال شود."
  },
  {
    "id": "ch5_q3",
    "type": "short",
    "question": "DMARC چیست و چه ارتباطی با SPF و DKIM دارد؟",
    "answer": "**DMARC (Domain-based Message Authentication, Reporting, and Conformance)** یک سیاست امنیتی است که به گیرنده می‌گوید اگر SPF و/یا DKIM ایمیل تأیید نشد چه کاری انجام دهد و همچنین گزارش‌هایی درباره وضعیت احراز هویت ایمیل ارسال می‌کند.",
    "hint": "- **DMARC = قاضی ایمیل**\n- بررسی می‌کند آیا SPF و DKIM موفق بودند و سپس سیاست را اجرا می‌کند.",
    "extra": "### سیاست‌ها:\n- none: فقط گزارش.\n- quarantine: رفتن ایمیل به اسپم.\n- reject: رد کامل ایمیل.\n\n### ADHD نکته:\nDMARC را مثل قاضی تصور کن که نظر دو شاهد (SPF و DKIM) را می‌شنود و حکم می‌دهد."
  },
  {
    "id": "ch5_q4",
    "type": "short",
    "question": "چگونه SPF در DNS پیکربندی می‌شود؟",
    "answer": "SPF به صورت یک رکورد TXT در DNS دامنه اضافه می‌شود که شامل لیستی از سرورهای مجاز و قوانین بررسی است، مثلاً: `v=spf1 ip4:192.0.2.0/24 include:_spf.google.com -all`.",
    "hint": "- **v=spf1** آغاز رکورد.\n- include = افزودن رکوردهای دیگر.\n- -all = رد سایر سرورها.",
    "extra": "### مراحل:\n1. شناسایی همه سرورهای مجاز ارسال.\n2. ساخت رکورد TXT با قالب SPF.\n3. انتشار در DNS.\n4. تست با ابزارهای آنلاین.\n\n### ADHD نکته:\nبهش فکر کن مثل نوشتن لیست مهمان برای ورود به ساختمان."
  },
  {
    "id": "ch5_q5",
    "type": "short",
    "question": "چگونه DKIM برای یک دامنه فعال می‌شود؟",
    "answer": "فعال‌سازی DKIM شامل تولید یک جفت کلید عمومی/خصوصی، ذخیره کلید عمومی به صورت رکورد TXT در DNS دامنه، و پیکربندی سرور ایمیل برای امضا کردن پیام‌ها با کلید خصوصی است.",
    "hint": "- کلید خصوصی = فقط نزد فرستنده.\n- کلید عمومی = در DNS برای تأیید گیرنده.\n- Selector برای انتخاب رکورد صحیح استفاده می‌شود.",
    "extra": "### مراحل:\n1. تولید کلیدها.\n2. ایجاد رکورد TXT با نامی مثل `selector._domainkey.example.com`.\n3. فعال‌سازی در سرور ایمیل.\n4. تست با ارسال ایمیل به سرویس‌های بررسی DKIM.\n\n### ADHD نکته:\nمثل داشتن یک امضای خاص که فقط خودت داری ولی نمونه‌اش را در یک تابلو عمومی نصب کرده‌ای تا همه بتوانند صحت امضایت را بررسی کنند."
  },
  {
    "id": "ch5_q6",
    "type": "short",
    "question": "تحلیل هدر ایمیل چه کمکی به امنیت می‌کند؟",
    "answer": "هدر ایمیل شامل مسیر، سرورهای واسطه، امضای DKIM، نتیجه SPF، و سایر اطلاعات فنی است که با بررسی آن می‌توان فرستنده واقعی، تغییرات مسیر، و نتایج احراز هویت را شناسایی کرد.",
    "hint": "- هدر = شناسنامه کامل سفر ایمیل.\n- بررسی `Received`, `Authentication-Results` و `Return-Path` بسیار مهم است.",
    "extra": "### موارد بررسی:\n- **Received:** مسیر عبور ایمیل.\n- **Authentication-Results:** نتیجه SPF/DKIM/DMARC.\n- **From و Return-Path:** برای کشف Spoofing.\n\n### ADHD نکته:\nهدر را مثل دفترچه مسافر تصور کن که مهر همه مرزهایی که رد شده در آن ثبت شده."
  },
  {
    "id": "ch5_q7",
    "type": "short",
    "question": "چگونه ایمیل جعلی (Spoofed) را تشخیص می‌دهید؟",
    "answer": "با مقایسه دامنه در `From` با `Return-Path` و بررسی نتایج SPF و DKIM، و همچنین تحلیل مسیر `Received`، می‌توان ایمیل جعلی را شناسایی کرد. وجود ناهماهنگی یا Fail در این بخش‌ها نشانه خطر است.",
    "hint": "- تفاوت بین From و Return-Path.\n- SPF/DKIM Fail یا Missing.\n- مسیر غیرمنتظره در Received.",
    "extra": "### نشانه‌ها:\n- هدرهای ناقص یا غیرعادی.\n- دامنه فرستنده شبیه‌سازی شده (typosquatting).\n- لینک‌های مخرب در متن.\n\n### ADHD نکته:\nاین را شبیه تماس تلفنی از کسی ببین که صدایش شبیه دوستت است ولی شماره‌اش ناشناس است."
  },
  {
    "id": "ch5_q8",
    "type": "short",
    "question": "ARC (Authenticated Received Chain) چیست؟",
    "answer": "**ARC** مکانیزمی است که امکان حفظ نتایج احراز هویت ایمیل را در طول فوروارد و عبور از چندین سرور فراهم می‌کند، حتی اگر SPF یا DKIM در مسیر Fail شود.",
    "hint": "- ARC = دفترچه تاریخچه احراز هویت.\n- کمک می‌کند ایمیل معتبر در فوروارد اشتباهی اسپم نشود.",
    "extra": "### کاربرد:\n- برای سرویس‌هایی که ایمیل را فوروارد می‌کنند (Mailing Lists).\n- نگهداری امضاها و نتایج اصلی احراز هویت.\n\n### ADHD نکته:\nARC را مثل پاسپورت ایمیل تصور کن که همه مهرهای سفرش را ثبت کرده."
  },
  {
    "id": "ch5_q9",
    "type": "short",
    "question": "BIMI چیست و چه ربطی به امنیت ایمیل دارد؟",
    "answer": "**BIMI (Brand Indicators for Message Identification)** استانداردی است که به ایمیل‌های معتبر اجازه می‌دهد لوگوی رسمی برند در کنار پیام نمایش داده شود، ولی فقط زمانی فعال می‌شود که SPF, DKIM, DMARC به درستی پاس شوند.",
    "hint": "- BIMI = مهر برند روی ایمیل معتبر.\n- نیازمند DMARC Policy سختگیرانه.",
    "extra": "### کاربرد:\n- افزایش اعتماد کاربر.\n- کاهش احتمال کلیک روی ایمیل‌های جعلی.\n\n### ADHD نکته:\nBIMI را مثل نشان تجاری روی یک نامه رسمی در نظر بگیر."
  },
  {
    "id": "ch5_q10",
    "type": "short",
    "question": "چگونه ترکیب SPF، DKIM و DMARC امنیت ایمیل را کامل می‌کند؟",
    "answer": "ترکیب **SPF، DKIM و DMARC** سه لایه اصلی امنیت ایمیل را فراهم می‌کند: SPF بررسی می‌کند آیا فرستنده مجاز است؛ DKIM تضمین می‌کند پیام در مسیر تغییر نکرده؛ و DMARC تصمیم می‌گیرد با ایمیل‌هایی که Fail شدند چه برخوردی شود، ضمن ارسال گزارش برای بهبود پیکربندی.",
    "hint": "- SPF = شناسنامه فرستنده.\n- DKIM = مهر و موم پیام.\n- DMARC = قاضی و قانون‌گذار.\n- این سه با هم تقریباً همه مسیرهای Spoofing را می‌بندند.",
    "extra": "### نتیجه:\n- افزایش اعتماد گیرنده.\n- کاهش موفقیت حملات فیشینگ.\n- ارائه گزارش‌های ارزشمند به مدیران امنیت.\n\n### ADHD نکته:\nاین سه‌تا را مثل دروازه‌بان، مدافع و داور یک مسابقه فوتبال تصور کن که با هم جلوی گل خوردن را می‌گیرند."
  }
]
